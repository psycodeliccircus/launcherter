<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Launcher Trilhas Elite Brasil</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.all.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>

<body class="body">
    <div class="container">
        <h1 class="mt-4">
            <img src="https://renildomarcio.com.br/content/uploads/photos/2024/01/renildomarcio_e561cafdb1fa7b4ebdbdfe523968f662.png"
                alt="Logo da ETS2 Mod Downloader" width="100" height="100">
        </h1>
        <p class="mt-4">Sistema Atualizado em: <strong>30/01/2024</strong></p>
        <br>

        <!-- Tabs Section -->
        <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="home-tab-pane-tab" data-bs-toggle="pill" data-bs-target="#home-tab-pane" type="button" role="tab" aria-controls="home-tab-pane" aria-selected="true">Home</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="profile-tab-pane-tab" data-bs-toggle="pill" data-bs-target="#profile-tab-pane" type="button" role="tab" aria-controls="profile-tab-pane" aria-selected="false">Nossas Redes Sociais</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="contact-tab-pane-tab" data-bs-toggle="pill" data-bs-target="#contact-tab-pane" type="button" role="tab" aria-controls="contact-tab-pane" aria-selected="false">Contato</button>
            </li>
            <li class="nav-item" role="presentation">
               <button class="nav-link" id="server-ets-tab" data-bs-toggle="pill" data-bs-target="#server-ets" type="button" role="tab" aria-controls="server-ets" aria-selected="false">Servidor ETS2</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="pills-disabled2-tab" data-bs-toggle="pill" data-bs-target="#pills-disabled2" type="button" role="tab" aria-controls="pills-disabled2" aria-selected="false" disabled>Servidor ATS</button>
             </li>
          </ul>
        <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade show active" id="home-tab-pane" role="tabpanel" aria-labelledby="home-tab"
                tabindex="0"><h1>Todos Arquivos para Download</h1><br><div id="buttons" class="mb-4"></div>
                <div id="progress"></div></div>
            <div class="tab-pane fade" id="profile-tab-pane" role="tabpanel" aria-labelledby="profile-tab"
                tabindex="0"><h1>Redes Sociais</h1><br><p>Nossa Rede Social oficial: <a class="btn btn-primary" href="https://renildomarcio.com.br/pages/trilhaselite" role="button">Trilha Elite Brasil</a></p></div>
            <div class="tab-pane fade" id="contact-tab-pane" role="tabpanel" aria-labelledby="contact-tab"
                tabindex="0"><h1>E-mails de contato</h1><br><p>Nosso email oficial: renildomrc@gmail.com</p></div>
            <div class="tab-pane fade" id="server-ets" role="tabpanel" aria-labelledby="server-ets-tab" tabindex="0">
                <table id="statusTable" class="table table-dark">
                    <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">Server / ID</th>
                            <th scope="col">Status</th>
                            <th scope="col">Host</th>
                            <th scope="col">Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- As linhas da tabela serão adicionadas dinamicamente aqui -->
                    </tbody>
                </table>
            </div>
        </div>
        <!-- End of Tabs Section -->
    </div>

    <!-- Rodapé fixo -->
    <div id="launcher-version">
        <p>Launcher V 1.0.4</p>
    </div>

    <div id="dev-rm">
        <p>Desenvolvido por: RenildoMarcio</p>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.10/clipboard.min.js"></script>
    <script>
        function atualizarTabela() {
            $.getJSON('https://api.renildomarcio.com.br/status_server.json', function(data) {
                $('#statusTable tbody').empty();

                $.each(data, function(index, server) {
                    var row = '<tr class="' + (index % 0 === 0 ? 'table-active' : '') + '">' +
                                  '<th scope="row">' + (index + 1) + '</th>' +
                                  '<td>' + server.serverId + '</td>' +
                                  '<td class="status-' + server.status.toLowerCase() + '"><img src="status/' + server.status.toLowerCase() + '.png" width="26" height="26"><b>' + server.status + '</b></td>' +
                                  '<td>' + server.host + '</td>' +
                                  '<td><button type="button" class="btn btn-primary copy-button" data-clipboard-text="' + server.serverId + '">Copiar</button></td>' +
                              '</tr>';

                    $('#statusTable tbody').append(row);
                });

                // Inicializar o Clipboard.js para o botão de cópia
                var clipboard = new ClipboardJS('.copy-button');

                // Exibir mensagem de sucesso ao copiar
                clipboard.on('success', function(e) {
                    alert('Server ID copiado para a área de transferência: ' + e.text);
                    e.clearSelection();
                });

                // Exibir mensagem de erro ao falhar na cópia
                clipboard.on('error', function(e) {
                    alert('Falha ao copiar o Server ID. Por favor, selecione e copie manualmente.');
                });
            });
        }

        atualizarTabela();
        setInterval(atualizarTabela, 60000);
    </script>

    <script>
        const filesToDownload = [
            'Base1_Trilhas_Elite.scs',
            'Base2_Trilhas_Elite.scs',
            'Base3_Trilhas_Elite.scs',
            'Base4_Trilhas_Elite_DLCs.scs',
            'Mapa_Trilhas_Elite.scs'
        ];

        const buttonsDiv = document.getElementById('buttons');
        filesToDownload.forEach(fileName => {
            const button = document.createElement('button');
            button.textContent = `Download ${fileName}`;
            button.onclick = () => startDownload(fileName);
            button.className = 'btn btn-dark';
            buttonsDiv.appendChild(button);
        });

        function startDownload(fileName) {
            window.api.send('startDownload', fileName);
        }

        window.api.receive('downloadProgress', progress => {
            const progressDiv = document.getElementById('progress');
            progressDiv.innerHTML = `
                <p>Arquivo: ${progress.fileName}</p>
                <p>Tamanho total: ${formatBytes(progress.totalSize)}</p>
                <p>Tamanho baixado: ${formatBytes(progress.downloadedSize)}</p>
                <p>Velocidade: ${formatBytes(progress.speed)}/s</p>
                <p>Porcentagem: ${progress.percentage.toFixed(2)}%</p>
            `;
        });

        window.api.receive('downloadCompleted', data => {
            const progressDiv = document.getElementById('progress');
            progressDiv.innerHTML = '';

            const alertDiv = document.createElement('div');
            alertDiv.className = 'alert alert-success d-flex align-items-center';
            alertDiv.setAttribute('role', 'alert');
            alertDiv.innerHTML = `<div><strong>Download concluído para ${data.fileName}.</strong></div>`;

            document.getElementById('progress').insertAdjacentElement('afterbegin', alertDiv);

            setTimeout(() => {
                alertDiv.classList.add('fade');
                setTimeout(() => {
                    alertDiv.remove();
                }, 1000);
            }, 10000);
        });

        function formatBytes(bytes, decimals = 2) {
            if (bytes === 0) return '0 Bytes';

            const k = 1024;
            const dm = decimals < 0 ? 0 : decimals;
            const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];

            const i = Math.floor(Math.log(bytes) / Math.log(k));

            return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
        }
    </script>

    <!-- Bootstrap Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>
